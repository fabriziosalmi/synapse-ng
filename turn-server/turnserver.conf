# Configurazione coturn per Synapse-NG
# Coturn TURN/STUN server per NAT traversal robusto

# ===== LISTENING PORTS =====
# Porta principale per STUN/TURN
listening-port=3478

# Porta TLS (opzionale, per produzione)
# tls-listening-port=5349

# ===== RELAY CONFIGURATION =====
# Range di porte per relay (traffico P2P effettivo)
min-port=49152
max-port=65535

# ===== AUTHENTICATION =====
# Modalità: long-term credentials (raccomandato per WebRTC)
lt-cred-mech

# User/password per autenticazione
# Formato: username=password
# IMPORTANTE: Cambia queste credenziali in produzione!
user=synapse:changeme123
user=admin:admin456

# Oppure usa static-auth-secret per generazione dinamica
# static-auth-secret=my-secret-key-change-in-production

# ===== REALM =====
# Realm per autenticazione (dominio del servizio)
realm=synapse-ng.local

# ===== NETWORK =====
# IP esterno del server (per NAT traversal)
# Se il server TURN è dietro NAT, specifica l'IP pubblico
# external-ip=YOUR_PUBLIC_IP

# IP interno del server
# listening-ip=0.0.0.0

# ===== RELAY IPs =====
# IP da cui fare relay del traffico
# relay-ip=0.0.0.0

# ===== LOGGING =====
# Livello log (verbose per debug, 3 per produzione)
verbose

# Log file
log-file=/var/log/turnserver.log

# ===== SECURITY =====
# Nega connessioni da IP privati (sicurezza)
no-loopback-peers
no-multicast-peers

# Limita bandwidth per client (in Kbps)
# max-bps=500000

# ===== FINGERPRINT =====
# Abilita STUN fingerprint (richiesto da WebRTC)
fingerprint

# ===== MOBILITY =====
# Supporto ICE mobility
mobility

# ===== STUN ONLY MODE (opzionale) =====
# Se vuoi solo STUN senza TURN relay, decommenta:
# stun-only

# ===== TLS CONFIGURATION (opzionale) =====
# cert=/path/to/cert.pem
# pkey=/path/to/privkey.pem
# cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512"

# ===== DATABASE (opzionale) =====
# Per persistenza utenti e statistiche
# userdb=/var/db/turndb
# psql-userdb="host=localhost dbname=turn user=turn password=turn"

# ===== PROMETHEUS METRICS (opzionale) =====
# prometheus
# prometheus-port=9641
